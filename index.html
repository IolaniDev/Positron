<!DOCTYPE html>
<html>
<head>
<title>'Iolani Positron Clock</title>
<meta name = "Program Name" content = "Positron">
<meta name = "Version" content = "0.1">
<meta name = "Author" content = "Korry Luke">

<script type = "text/javascript">
// Load schedule
var periods = [
	new Date(2014, 4, 21, 7, 50),
	new Date(2014, 4, 21, 8, 34),
	new Date(2014, 4, 21, 8, 39),
	new Date(2014, 4, 21, 9, 23),
	new Date(2014, 4, 21, 9, 28),
	new Date(2014, 4, 21, 10, 12),
	new Date(2014, 4, 21, 10, 17),
	new Date(2014, 4, 21, 11, 01),
	new Date(2014, 4, 21, 11, 06),
	new Date(2014, 4, 21, 11, 50),
	new Date(2014, 4, 21, 12, 38),
	new Date(2014, 4, 21, 13, 22),
	new Date(2014, 4, 21, 13, 27),
	new Date(2014, 4, 21, 14, 11),
	new Date(2014, 4, 21, 14, 16),
	new Date(2014, 4, 21, 15, 00),
];

function init()	{
	timeDisplay = document.createTextNode("");
	document.getElementById("Clock").appendChild(timeDisplay);
	document.getElementById("ISOcalendar").appendChild(timeDisplay);
	document.getElementById("calendar").appendChild(timeDisplay);
	document.getElementById("scroller").appendChild(timeDisplay);
	document.getElementById("cycleSchedule").appendChild(timeDisplay);
}

function updateClock()	{
	var militaryTime = false;
	var currentTime = new Date();
	var mon = currentTime.getMonth();
	var wkday = currentTime.getDay();
	var date = currentTime.getDate();
	var yr = currentTime.getFullYear();
	var hrs = currentTime.getHours();
	var min = currentTime.getMinutes();
	var sec = currentTime.getSeconds();
	var mon = monthToString(mon);
	var wkday = dayToString(wkday);
	var min = normalize(min);
	var sec = normalize(sec);
	var meridiem = "";
	var nextEventIndex = 0;
	if(!militaryTime)	{
		meridiem = (hrs < 12) ? "AM" : "PM";
		hrs = (hrs > 12) ? (hrs - 12) : hrs;
		hrs = (hrs == 0) ? (12) : hrs;
	}
	//Determine nextEventIndex
	while (currentTime > periods[nextEventIndex])	{
		nextEventIndex ++;
	}
	currentCycle = 7;
	currentSchedule = "Basic"
	//Calculate time left
	timeLeft = periods[nextEventIndex] - currentTime;
	minutesLeft = Math.round(timeLeft / 60000);
	//Calculate next Event period number
	var word = "";
	var period = -1;
	switch (nextEventIndex)	{
		case 0 : period = 7; word = "start"; break;
		case 1 : period = 7; word = "end"; break;
		case 2 : period = 8; word = "start"; break
		case 3 : period = 8; word = "end"; break;
		case 4 : period = 1; word = "start"; break;
		case 5 : period = 1; word = "end"; break;
		case 6 : period = 2; word = "start"; break;
		case 7 : period = 2; word = "end"; break;
		case 8 : period = 5; word = "start"; break;
		case 9 : period = 5; word = "end"; break;
		case 10 :period = 6; word = "start"; break;
		case 11 :period = 6; word = "end"; break;
		case 12 :period = 3; word = "start"; break;
		case 13 :period = 3; word = "end"; break;
		case 14 :period = 4; word = "start"; break;
		case 15 :period = 4; word = "end"; break;
		} 

	var scrollerString = (sec > 1) ? (minutesLeft + " minutes to " + word + " of Period " + period) : (minutesLeft + "minute to " + word + " of Period " + period);
	var timeString = hrs + ":" + min + ":" + sec + " " + meridiem;
	var cycleScheduleString = "Cycle " + currentCycle + " " + currentSchedule; 
	// Compose the string for display
	var dateString = wkday + ", " + mon + " " + date + ", " + yr;

	// Update the time display
	document.getElementById("clock").firstChild.nodeValue = timeString;
	document.getElementById("calendar").firstChild.nodeValue = dateString;
	document.getElementById("scroller").firstChild.nodeValue =  scrollerString; 
	document.getElementById("cycleSchedule").firstChild.nodeValue =  cycleScheduleString;
}

function normalize(time)  {
	if(time < 10) { time = "0" + time};
	return time;
}

function monthToString(month)	{
	switch (month)	{
		case 0 : month = "January"; break;
		case 1 : month = "February"; break;
		case 2 : month = "March"; break
		case 3 : month = "April"; break;
		case 4 : month = "May"; break;
		case 5 : month = "June"; break;
		case 6 : month = "July"; break;
		case 7 : month = "August"; break;
		case 8 : month = "September"; break;
		case 9 : month = "October"; break;
		case 10 : month = "November"; break;
		case 11 : month = "December"; break;
	}
	return month;
}

function dayToString(day)	{
	switch(day)	{
		case 0 : day = "Sunday"; break;
		case 1 : day = "Monday"; break;
		case 2 : day = "Tuesday"; break;
		case 3 : day = "Wednesday"; break;
		case 4 : day = "Thursday"; break;
		case 5 : day = "Friday"; break;
		case 6 : day = "Saturday"; break;
	}
	return day;
}

</script>
</head>

<body onload = 'updateClock(); setInterval("updateClock()", 500)'>

<table align = 'center'>
<tr><td>&nbsp;</td></tr>
<tr><td>&nbsp;</td></tr>
<tr><td id = "calendar">&nbsp;</td></tr>
<tr><td id = "cycleSchedule">&nbsp;</td></tr>
<tr><td id = "clock">&nbsp;</td></tr>
<tr><td>&nbsp;</td></tr>
<tr><td><marquee behavior = "scroll" scrollAmt = "5" scrollDelay = "0" id = "scroller">&nbsp;</marquee></td></tr>
</table>
</body>
</html>